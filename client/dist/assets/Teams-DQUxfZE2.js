import{j as e}from"./animations-CVxur35w.js";import{r as n}from"./vendor-dbpypOpC.js";import{z as r,D as M}from"./DashboardShell-Bzp3PMd2.js";import{B as f,C as j,I as R}from"./Badge-CuQR1N-9.js";import{a as F}from"./Skeleton-DtGl1t5O.js";import{u as L,e as i}from"./index-BPDhQj-8.js";import"./icons-BJJ_CL-s.js";function B(){const{user:T}=L(),[x,u]=n.useState([]),[_,g]=n.useState(!0),[h,N]=n.useState(!1),[d,b]=n.useState({name:"",description:""}),[t,y]=n.useState(null),[c,v]=n.useState("");n.useEffect(()=>{p()},[T]);const p=async()=>{try{g(!0);const a=await(await fetch(`${i.baseURL}/teams/my`,{credentials:"include"})).json();u(Array.isArray(a)?a:[])}catch(s){console.error("Failed to fetch teams:",s),r.error("Failed to load teams"),u([])}finally{g(!1)}},S=async()=>{if(!d.name){r.error("Team name is required");return}try{const a=await(await fetch(`${i.baseURL}/teams`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json();u([...x,a]),b({name:"",description:""}),N(!1),r.success("Team created successfully")}catch{r.error("Failed to create team")}},$=async()=>{if(!(!t||!c))try{const o=(await(await fetch(`${i.baseURL}/users/search?q=${c}`,{credentials:"include"})).json()).find(m=>m.email===c);if(!o){r.error("User not found");return}await fetch(`${i.baseURL}/teams/${t._id}/members`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:o._id,role:"member"})}),p(),y(null),v(""),r.success("Member added successfully")}catch{r.error("Failed to add member")}},E=async(s,a)=>{try{await fetch(`${i.baseURL}/teams/${s}/members/${a}`,{method:"DELETE",credentials:"include"}),p(),r.success("Member removed")}catch{r.error("Failed to remove member")}};return _?e.jsx(F,{count:3}):e.jsx(M,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-900 dark:text-slate-50 mb-2",children:"Teams"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Collaborate with your team members"})]}),e.jsx(f,{onClick:()=>N(!h),className:"bg-blue-600 hover:bg-blue-700",children:h?"Cancel":"Create Team"})]}),h&&e.jsxs(j,{className:"glass-effect p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50 mb-4",children:"Create New Team"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{label:"Team Name",value:d.name,onChange:s=>b({...d,name:s.target.value}),placeholder:"Enter team name"}),e.jsx("textarea",{className:"w-full p-2 rounded bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-50",placeholder:"Team description (optional)",value:d.description,onChange:s=>b({...d,description:s.target.value}),rows:3}),e.jsx(f,{onClick:S,className:"bg-green-600 hover:bg-green-700 w-full",children:"Create Team"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(s=>{var a,o,m,w;return e.jsxs(j,{className:"glass-effect p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:s.name}),s.description&&e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:s.description})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-slate-900 dark:text-slate-50 mb-2",children:["Members (",((a=s.members)==null?void 0:a.length)||0,")"]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:(o=s.members)==null?void 0:o.map(l=>{var C,k;return e.jsxs("div",{className:"flex justify-between items-center bg-slate-100 dark:bg-slate-800 p-2 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-900 dark:text-slate-50 text-sm font-semibold",children:(C=l.userId)==null?void 0:C.name}),e.jsx("p",{className:"text-xs text-slate-500",children:l.role})]}),l.role!=="admin"&&e.jsx("button",{onClick:()=>E(s._id,l.userId._id),className:"text-red-600 hover:text-red-700 text-xs font-semibold",children:"Remove"})]},(k=l.userId)==null?void 0:k._id)})})]}),((m=s.owner)==null?void 0:m._id)===((w=s.owner)==null?void 0:w._id)&&e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("button",{onClick:()=>y((t==null?void 0:t._id)===s._id?null:s),className:"text-blue-600 hover:text-blue-700 text-sm font-semibold w-full p-2 hover:bg-blue-50 dark:hover:bg-blue-900 rounded",children:(t==null?void 0:t._id)===s._id?"Cancel":"Add Member"}),(t==null?void 0:t._id)===s._id&&e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("input",{id:`member-email-${s._id}`,type:"email",placeholder:"Member email",value:c,onChange:l=>v(l.target.value),autoComplete:"email",className:"w-full p-2 rounded bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-50 text-sm"}),e.jsx(f,{onClick:$,size:"sm",className:"bg-green-600 hover:bg-green-700 w-full",children:"Add"})]})]})]},s._id)})}),x.length===0&&e.jsx(j,{className:"glass-effect p-12 text-center",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-lg",children:"No teams yet. Create one to get started!"})})]})})}export{B as default};
