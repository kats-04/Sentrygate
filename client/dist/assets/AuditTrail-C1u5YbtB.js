import{j as r}from"./animations-CVxur35w.js";import{r as N}from"./vendor-dbpypOpC.js";import{u as w}from"./useQuery-DjR0J6Gq.js";import{C as i,a as k}from"./Badge-CuQR1N-9.js";import{D as p}from"./DashboardShell-Bzp3PMd2.js";import{e as y}from"./index-BPDhQj-8.js";import{j as v,b as A,C,l as D}from"./icons-BJJ_CL-s.js";function M(){var h;const[n,u]=N.useState(""),{data:a,isLoading:f,error:S}=w({queryKey:["activities"],queryFn:async()=>{const e=await y.get("/activities?limit=50");return console.log("Activities API Response:",e),e}}),t=Array.isArray((h=a==null?void 0:a.data)==null?void 0:h.data)?a.data.data:Array.isArray(a==null?void 0:a.data)?a.data:[];console.log("Extracted activities:",t);const x=Array.isArray(t)?t.filter(e=>{var s,l;return((s=e.actionType)==null?void 0:s.toLowerCase().includes(n.toLowerCase()))||((l=e.message)==null?void 0:l.toLowerCase().includes(n.toLowerCase()))}):[],b=e=>{const s=new Date(e),d=new Date-s,o=Math.floor(d/(24*60*60*1e3)),c=Math.floor(d%(24*60*60*1e3)/(60*60*1e3)),m=Math.floor(d%(60*60*1e3)/(60*1e3));return o>0?`${o} day${o>1?"s":""} ago`:c>0?`${c} hour${c>1?"s":""} ago`:m>0?`${m} minute${m>1?"s":""} ago`:"Just now"},j=e=>e!=null&&e.includes("REGISTER")||e!=null&&e.includes("LOGIN")?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":e!=null&&e.includes("LOGOUT")||e!=null&&e.includes("UPDATE")?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",g={total:Array.isArray(t)?t.length:0,today:Array.isArray(t)?t.filter(e=>{const s=new Date;return new Date(e.createdAt).toDateString()===s.toDateString()}).length:0};return r.jsxs(p,{children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-headline-2 mb-2",children:"Audit Trail"}),r.jsx("p",{className:"text-body-small",children:"Complete security and activity log"})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs(i,{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Events"}),r.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:g.total})]}),r.jsxs(i,{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Today"}),r.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400 mt-2",children:g.today})]})]}),r.jsx(i,{className:"p-4",children:r.jsx("div",{className:"flex gap-4",children:r.jsxs("div",{className:"flex-1 relative",children:[r.jsx(v,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search by action or message...",value:n,onChange:e=>u(e.target.value),className:"pl-10 w-full px-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800"})]})})}),r.jsx(i,{className:"overflow-hidden",children:f?r.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading activities..."}):x.length===0?r.jsx("div",{className:"p-8 text-center text-gray-500",children:"No activities found"}):r.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:x.map(e=>{var s,l,d;return r.jsxs("div",{className:`p-6 transition ${e.isHighRisk||e.severity==="critical"||e.severity==="high"?"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,children:[r.jsxs("div",{className:"flex items-start justify-between mb-3 flex-wrap gap-2",children:[r.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.severity==="critical"||e.severity==="high"?r.jsx(A,{className:"w-4 h-4 text-red-600 flex-shrink-0"}):r.jsx(C,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:e.actionType}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e.message||`${((s=e.actorId)==null?void 0:s.name)||"User"} - ${e.actionType}`})]})]}),r.jsx(k,{className:j(e.actionType),children:e.actionType})]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400 flex-wrap",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(D,{className:"w-4 h-4"}),b(e.createdAt)]}),r.jsxs("div",{className:"hidden md:block",children:["User: ",((l=e.actorId)==null?void 0:l.name)||((d=e.actorId)==null?void 0:d.email)||"Unknown"]})]})]},e._id)})})})]})]})}export{M as default};
